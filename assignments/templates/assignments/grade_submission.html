{% extends 'accounts/base.html' %}
{% block content %}
<div class="max-w-3xl mx-auto px-6 py-10">
  
  <!-- Header -->
  <div class="bg-gradient-to-r from-indigo-50 to-white border border-indigo-100 rounded-2xl shadow-sm p-6 mb-8">
    <h2 class="text-3xl font-bold text-gray-800 flex items-center gap-2">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 20h9M12 4v16m0-16L3 12l9 8"/>
      </svg>
      Grade Submission
    </h2>
    <p class="text-gray-600 mt-1">Review and score student work for this assignment.</p>
  </div>

  <!-- Submission Info -->
  <div class="bg-white border border-gray-100 rounded-2xl shadow-sm p-6">
    <div class="space-y-2 text-gray-700">
      <p><span class="font-semibold text-gray-800">Assignment:</span> {{ submission.assignment.title }}</p>
      <p><span class="font-semibold text-gray-800">Student:</span> {{ submission.student }}</p>
      <p><span class="font-semibold text-gray-800">Submitted:</span> {{ submission.submitted_on|date:"M d, Y H:i" }}</p>
    </div>

    {% if submission.text %}
    <div class="mt-5 bg-gray-50 border border-gray-100 rounded-xl p-4">
      <h3 class="font-semibold text-gray-800 mb-2">Student Response</h3>
      <p class="text-gray-700 whitespace-pre-line">{{ submission.text }}</p>
    </div>
    {% endif %}

    {% if submission.files.all %}
    <div class="mt-5">
      <h3 class="font-semibold text-gray-800 mb-2">Submitted Files</h3>
      <ul class="list-disc ml-6 space-y-1">
        {% for f in submission.files.all %}
          <li>
            <a href="{% url 'assignments:download_submission_file' file_id=f.id %}" 
               class="text-indigo-600 hover:text-indigo-800 transition font-medium">
              ğŸ“ {{ f.filename|default:"Download file" }}
            </a>
          </li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}
  </div>

  <!-- Grading Form -->
  <div class="mt-8 bg-white border border-gray-100 rounded-2xl shadow-sm p-6">
    <h3 class="text-xl font-semibold text-gray-800 mb-4">Enter Grade</h3>
    <form method="post" class="space-y-6">
      {% csrf_token %}
      <div class="space-y-4">
        {% for field in form %}
        <div>
          <label for="{{ field.id_for_label }}" class="block text-sm font-medium text-gray-700 mb-1">
            {{ field.label }}
          </label>
          <div class="mt-1">
            {{ field }}
          </div>
          {% if field.help_text %}
          <p class="text-xs text-gray-500 mt-1">{{ field.help_text }}</p>
          {% endif %}
          {% for error in field.errors %}
          <p class="text-sm text-red-600">{{ error }}</p>
          {% endfor %}
        </div>
        {% endfor %}
      </div>

      <div class="flex items-center gap-4 pt-4 border-t border-gray-100">
        <button type="submit" 
                class="px-5 py-2.5 bg-green-600 hover:bg-green-700 text-white font-medium rounded-lg shadow transition">
          ğŸ’¾ Save Grade
        </button>
        <a href="{% url 'assignments:teacher_assignment_detail' pk=submission.assignment.id %}" 
           class="px-5 py-2.5 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium rounded-lg transition">
          â† Back
        </a>
      </div>
    </form>
  </div>

</div>
{% endblock %}
