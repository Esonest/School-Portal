{% extends "accounts/base.html" %}
{% block content %}

<div class="min-h-screen bg-gray-100 p-4 sm:p-6">

  <div class="max-w-7xl mx-auto space-y-6">

    <!-- Header -->
    <div class="bg-white shadow-lg rounded-xl p-6 text-center">
      <h2 class="text-2xl font-bold text-gray-800">
        {{ school.name }}
      </h2>
      <p class="text-sm text-gray-500 mt-1">
        {{ school_class.name }} — {{ session }} — 
        {% if result_type == "cumulative" %}
          Cumulative Result
        {% else %}
          Term {{ term }} Result
        {% endif %}
      </p>
    </div>

    <!-- Actions -->
    <div class="flex flex-wrap gap-3 justify-end">
      <a href="{% url 'results:download_class_results_pdf' school.id school_class.id %}?session={{ session }}&term={{ term }}&type={{ result_type }}"
         class="bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white px-4 py-2 rounded-lg text-sm font-semibold transition">
        Download PDF
      </a>
    </div>

    <!-- Results Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      {% for r in results %}
        <div class="bg-white shadow-lg rounded-xl p-5 space-y-2 hover:shadow-xl transition">
          <h3 class="font-bold text-lg text-gray-800">
            {{ r.student.full_name }}
          </h3>

          <p class="text-gray-700"><strong>Total:</strong> {{ r.overall_total }}</p>
          <p class="text-gray-700"><strong>Average:</strong> {{ r.avg|floatformat:2 }}</p>
          <p class="text-gray-700"><strong>Position:</strong> {{ r.position }} / {{ r.class_size }}</p>
          <p class="text-gray-700">
            <strong>Next Term Begins:</strong><br>
            {{ r.next_term_begins|date:"l, jS F Y"|default:"__________" }}
          </p>

          <a href="{% url 'results:student_view_result' r.student.id %}?session={{ session }}&term={{ term }}"
             class="inline-block mt-2 text-indigo-600 font-semibold hover:underline">
            View Full Result →
          </a>
        </div>
      {% empty %}
        <p class="text-center col-span-full text-gray-500">
          No results available.
        </p>
      {% endfor %}
    </div>

  </div>

</div>

{% endblock %}
