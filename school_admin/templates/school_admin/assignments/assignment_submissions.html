{% extends "accounts/base.html" %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6">

  <!-- HEADER -->
  <div class="mb-4">
    <h1 class="text-xl sm:text-2xl font-bold text-{{ school.theme_color }}-800">
      Submissions – {{ assignment.title }}
    </h1>
  </div>

  <!-- ===================== -->
  <!-- MOBILE CARDS VIEW -->
  <!-- ===================== -->
  <div class="md:hidden space-y-3">
    {% for sub in submissions %}
      <div class="bg-white border rounded-lg shadow-sm p-3 space-y-1">

        <div class="flex justify-between items-center mb-1">
          <h3 class="font-semibold text-gray-800 text-sm">
            {{ sub.student.full_name }}
          </h3>
          <span class="inline-flex px-2 py-0.5 rounded-full text-xs font-semibold text-white
            {% if sub.status == 'Submitted' %}bg-blue-600
            {% elif sub.status == 'Graded' %}bg-green-600
            {% elif sub.status == 'Pending' %}bg-yellow-500
            {% else %}bg-gray-500{% endif %}">
            {{ sub.status }}
          </span>
        </div>

        <div class="grid grid-cols-2 gap-1 text-xs sm:text-sm">
          <p><span class="font-medium">Score:</span> {{ sub.score|default:"-" }}</p>
          <p><span class="font-medium">Graded By:</span> {{ sub.graded_by|default:"-" }}</p>
          <p><span class="font-medium">Feedback:</span> {{ sub.feedback|default:"-" }}</p>
          <p><span class="font-medium">Submitted:</span> {{ sub.submitted_on|date:"d M Y H:i" }}</p>
        </div>

      </div>
    {% empty %}
      <p class="text-center text-gray-500 py-6">No submissions yet.</p>
    {% endfor %}
  </div>

  <!-- ===================== -->
  <!-- DESKTOP / TABLE VIEW -->
  <!-- ===================== -->
  <div class="hidden md:block bg-white border rounded-lg shadow-sm overflow-x-auto">

    <table class="min-w-full text-sm text-left border-collapse">
      <thead class="bg-gray-100 text-gray-700 uppercase text-xs tracking-wide">
        <tr>
          <th class="px-3 py-3 border">Student</th>
          <th class="px-3 py-3 border">Status</th>
          <th class="px-3 py-3 border text-center">Score</th>
          <th class="px-3 py-3 border">Feedback</th>
          <th class="px-3 py-3 border">Graded By</th>
          <th class="px-3 py-3 border text-center">Submitted On</th>
        </tr>
      </thead>

      <tbody class="divide-y divide-gray-100">
        {% for sub in submissions %}
          <tr class="hover:bg-gray-50 transition">
            <td class="px-3 py-2 border font-medium">{{ sub.student.full_name }}</td>
            <td class="px-3 py-2 border">
              <span class="inline-flex px-2.5 py-1 rounded-full text-xs font-semibold text-white
                {% if sub.status == 'Submitted' %}bg-blue-600
                {% elif sub.status == 'Graded' %}bg-green-600
                {% elif sub.status == 'Pending' %}bg-yellow-500
                {% else %}bg-gray-500{% endif %}">
                {{ sub.status }}
              </span>
            </td>
            <td class="px-3 py-2 border text-center">{{ sub.score|default:"-" }}</td>
            <td class="px-3 py-2 border">{{ sub.feedback|default:"-" }}</td>
            <td class="px-3 py-2 border">{{ sub.graded_by|default:"-" }}</td>
            <td class="px-3 py-2 border text-center">{{ sub.submitted_on|date:"d M Y H:i" }}</td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="6" class="text-center py-6 text-gray-500">No submissions yet.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- BACK BUTTON -->
  <a href="{% url 'school_admin:assignment_list' school.id %}"
     class="inline-block bg-gray-300 px-4 py-2 rounded hover:bg-gray-400 mt-4">
    ← Back to Assignments
  </a>

</div>
{% endblock %}
